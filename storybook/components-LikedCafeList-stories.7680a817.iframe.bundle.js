"use strict";(self.webpackChunkyozm_cafe=self.webpackChunkyozm_cafe||[]).push([[371],{"./src/components/LikedCafeList.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return LikedCafeList_stories}});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-router-dom/dist/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js");var hooks_useIntersection=(ref,options={})=>{const[entry,setEntry]=(0,react.useState)(null);return(0,react.useEffect)((()=>{if(ref.current){const observer=new IntersectionObserver((entries=>{setEntry(entries[0])}),options);return observer.observe(ref.current),()=>{setEntry(null),observer.disconnect()}}}),[ref.current,options.threshold,options.root,options.rootMargin]),entry},utils=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/utils.mjs"),queryObserver=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/queryObserver.mjs"),infiniteQueryBehavior=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/infiniteQueryBehavior.mjs");class InfiniteQueryObserver extends queryObserver.z{constructor(client,options){super(client,options)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(options,notifyOptions){super.setOptions({...options,behavior:(0,infiniteQueryBehavior.Gm)()},notifyOptions)}getOptimisticResult(options){return options.behavior=(0,infiniteQueryBehavior.Gm)(),super.getOptimisticResult(options)}fetchNextPage({pageParam:pageParam,...options}={}){return this.fetch({...options,meta:{fetchMore:{direction:"forward",pageParam:pageParam}}})}fetchPreviousPage({pageParam:pageParam,...options}={}){return this.fetch({...options,meta:{fetchMore:{direction:"backward",pageParam:pageParam}}})}createResult(query,options){var _state$fetchMeta,_state$fetchMeta$fetc,_state$fetchMeta2,_state$fetchMeta2$fet,_state$data,_state$data2;const{state:state}=query,result=super.createResult(query,options),{isFetching:isFetching,isRefetching:isRefetching}=result,isFetchingNextPage=isFetching&&"forward"===(null==(_state$fetchMeta=state.fetchMeta)||null==(_state$fetchMeta$fetc=_state$fetchMeta.fetchMore)?void 0:_state$fetchMeta$fetc.direction),isFetchingPreviousPage=isFetching&&"backward"===(null==(_state$fetchMeta2=state.fetchMeta)||null==(_state$fetchMeta2$fet=_state$fetchMeta2.fetchMore)?void 0:_state$fetchMeta2$fet.direction);return{...result,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,infiniteQueryBehavior.Qy)(options,null==(_state$data=state.data)?void 0:_state$data.pages),hasPreviousPage:(0,infiniteQueryBehavior.ZF)(options,null==(_state$data2=state.data)?void 0:_state$data2.pages),isFetchingNextPage:isFetchingNextPage,isFetchingPreviousPage:isFetchingPreviousPage,isRefetching:isRefetching&&!isFetchingNextPage&&!isFetchingPreviousPage}}}var useBaseQuery=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useBaseQuery.mjs");var client=__webpack_require__("./src/client.ts"),useUser=__webpack_require__("./src/hooks/useUser.ts");var hooks_useLikedCafes=()=>{const{data:user}=(0,useUser.Z)(),queryResult=function useInfiniteQuery(arg1,arg2,arg3){const options=(0,utils._v)(arg1,arg2,arg3);return(0,useBaseQuery.r)(options,InfiniteQueryObserver)}({queryKey:["likedCafes",user?.id],queryFn:({pageParam:pageParam=1})=>client.Z.getLikedCafeList(user?.id,pageParam).then((likedCafes=>({likedCafes:likedCafes,page:pageParam}))),getNextPageParam:lastPage=>lastPage.likedCafes.length>0?lastPage.page+1:void 0,enabled:!!user});return{...queryResult,data:queryResult.data,likedCafes:queryResult.data?.pages.flatMap((({likedCafes:likedCafes})=>likedCafes))??[]}},Resource=__webpack_require__("./src/utils/Resource.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const LikedCafeList=()=>{const{likedCafes:likedCafes,fetchNextPage:fetchNextPage,isFetching:isFetching,hasNextPage:hasNextPage}=hooks_useLikedCafes(),ref=(0,react.useRef)(null),intersection=hooks_useIntersection(ref,{threshold:1});return(0,react.useMemo)((()=>{hasNextPage&&!isFetching&&intersection?.isIntersecting&&fetchNextPage()}),[intersection]),(0,jsx_runtime.jsxs)(Container,{children:[(0,jsx_runtime.jsx)(TitleContainer,{children:(0,jsx_runtime.jsx)(Title,{children:"좋아요한 카페 리스트"})}),(0,jsx_runtime.jsxs)(ScrollContainer,{children:[(0,jsx_runtime.jsx)(GridContainer,{children:likedCafes.map((cafe=>(0,jsx_runtime.jsx)(dist.rU,{to:`/my-profile/cafes/${cafe.cafeId}`,children:(0,jsx_runtime.jsx)(CafeImage,{src:Resource.Z.getImageUrl({size:"500",filename:cafe.imageUrl}),alt:`Cafe ${cafe.cafeId}`},cafe.cafeId)},cafe.cafeId)))}),(0,jsx_runtime.jsx)(SensorContainer,{ref:ref})]})]})};LikedCafeList.displayName="LikedCafeList";var components_LikedCafeList=LikedCafeList;const Container=styled_components_browser_esm.zo.section`
  display: flex;
  flex-direction: column;
  height: 100%;
`,Title=styled_components_browser_esm.zo.h1`
  margin-bottom: ${({theme:theme})=>theme.space[3]};
  color: ${({theme:theme})=>theme.color.gray};
`,TitleContainer=styled_components_browser_esm.zo.article`
  display: flex;
  justify-content: center;
  margin-bottom: ${({theme:theme})=>theme.space[3]};
  border-bottom: solid ${({theme:theme})=>theme.color.line.secondary};
`,ScrollContainer=styled_components_browser_esm.zo.div`
  overflow-y: scroll;
  flex: 1;
`,GridContainer=styled_components_browser_esm.zo.div`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: ${({theme:theme})=>theme.space[.5]};
  margin-bottom: ${({theme:theme})=>theme.space[10]};
`,CafeImage=styled_components_browser_esm.zo.img`
  aspect-ratio: 1 / 1;
  width: 100%;
  height: 100%;
`,SensorContainer=styled_components_browser_esm.zo.div``;var LikedCafeList_stories={title:"LikedCafeList",component:components_LikedCafeList};const Default={args:{}};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {}\n}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/hooks/useSuspenseQuery.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useQuery.mjs");__webpack_exports__.Z=function useSuspenseQuery(options){const queryResult=(0,_tanstack_react_query__WEBPACK_IMPORTED_MODULE_0__.a)({...options,suspense:!0});return{...queryResult,isIdle:"isIdle"in queryResult&&queryResult.isIdle}}},"./src/hooks/useUser.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return hooks_useUser}});var client=__webpack_require__("./src/client.ts"),useMutation=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useMutation.mjs"),react=__webpack_require__("./node_modules/react/index.js"),AuthContext=__webpack_require__("./src/context/AuthContext.tsx");var hooks_useAuth=()=>{const authContext=(0,react.useContext)(AuthContext.Z);if(!authContext)throw new Error("AuthProvider를 사용해주셔야 합니다.");const{accessToken:accessToken,setAccessToken:setAccessToken,identity:identity}=authContext,{mutate:issueAccessToken}=(0,useMutation.D)({mutationFn:({provider:provider,code:code})=>client.Z.issueAccessToken(provider,code),onSettled:accessToken=>{setAccessToken(accessToken??null)}}),{mutate:clearRefreshToken}=(0,useMutation.D)({mutationFn:()=>client.Z.clearRefreshToken()});return{accessToken:accessToken,issueAccessToken:issueAccessToken,clearAuthorization:(0,react.useCallback)((()=>(setAccessToken(null),clearRefreshToken())),[clearRefreshToken]),identity:identity}},useSuspenseQuery=__webpack_require__("./src/hooks/useSuspenseQuery.ts");var hooks_useUser=()=>{const{identity:identity}=hooks_useAuth();return(0,useSuspenseQuery.Z)({queryKey:["user",identity],queryFn:()=>client.Z.getUser(identity?.sub),enabled:!!identity})}},"./src/utils/Resource.ts":function(__unused_webpack_module,__webpack_exports__){class Resource{constructor(){}static getImageUrl(options){const{filename:filename,size:size}=options;return Resource.joinPath("/images",size,filename)}static getAssetUrl(options){const{filename:filename}=options;return Resource.joinPath("/assets",filename)}static joinPath(...paths){return paths.map(((part,index)=>(index>0&&(part=part.replace(/^\/+/,"")),index!==paths.length-1&&(part=part.replace(/\/+$/,"")),part))).join("/")}}__webpack_exports__.Z=Resource}}]);
//# sourceMappingURL=components-LikedCafeList-stories.7680a817.iframe.bundle.js.map